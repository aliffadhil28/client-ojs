import{u as Q,b as a,j as e,B as c,T as l,P as n,Q as r,U as i,V as S}from"./Toast-VCx9N5bt.js";import{b as V,R as G,A as J,a as K}from"./buttonThemes-kdEAxNEq.js";import{I as A}from"./iconBase-9F2-WPdd.js";import{a as u}from"./axios-L6U4YIEh.js";const ee=()=>{document.title="Users List";const h=Q().data,v=a.useRef(),f=a.useRef(),C=a.useRef(),g=a.useRef(),b=a.useRef(),[R,P]=a.useState(""),[k,y]=a.useState(""),[E,N]=a.useState(""),[w,U]=a.useState(""),[m,q]=a.useState(""),[I,F]=a.useState(""),[x,D]=a.useState(0),[H,L]=a.useState([]),[M,o]=a.useState(!1),[B,j]=a.useState(!1),p=10,T=()=>{const s={username:f.current.value,email:v.current.value,password:C.current.value,noInduk:g.current.value,role:b.current.value};u.post("http://localhost:8001/users",s,{withCredentials:!0}).then(()=>{alert("User saved successfully"),o(!1)})},z=async s=>{const t={username:k,email:E,noInduk:w,role:I};m!==""&&(t.password=m),await u.put(`http://localhost:8001/users/${s}`,t,{withCredentials:!0}).then(d=>{console.log(d.data),alert("User updated successfully"),j(!1)}).catch(d=>{console.error(d),alert("User update failed")})};function $(s){u.delete(`http://localhost:8001/users/${s}`,{withCredentials:!0}).then(()=>{alert("User deleted Successfully")}).catch(t=>{console.error("Error deleting user:",t),alert("Failed to delete user")})}const O=s=>{u.get(`http://localhost:8001/users/${s}`,{withCredentials:!0}).then(t=>{const d=t.data.data;P(d.id),y(d.username),N(d.email),U(d.noInduk),F(d.role),j(!0)}).catch(t=>{console.error("Error fetching user data:",t.message),alert("Failed to fetch user data")})};return a.useEffect(()=>{L(h.filter((s,t)=>t>=x*p&&t<(x+1)*p))},[x,h]),e.jsxs("div",{className:"flex flex-col prose lg:prose-xl",children:[e.jsxs("div",{className:"header flex justify-between my-4",children:[e.jsx("h1",{className:"my-3 font-bold",children:"User List"}),e.jsx(c,{size:"sm",className:"me-4 w-24 h-10",theme:V,gradientMonochrome:"success",onClick:()=>o(!0),children:"Add"})]}),e.jsxs(l,{children:[e.jsxs(l.Head,{children:[e.jsx(l.HeadCell,{children:"Username"}),e.jsx(l.HeadCell,{children:"Email"}),e.jsx(l.HeadCell,{children:"No Induk"}),e.jsx(l.HeadCell,{children:"Role"}),e.jsx(l.HeadCell,{children:"Action"})]}),e.jsx(l.Body,{className:"divide-y",children:H.map((s,t)=>e.jsxs(l.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(l.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:s.username}),e.jsx(l.Cell,{children:s.email}),e.jsx(l.Cell,{children:s.noInduk}),e.jsx(l.Cell,{children:s.role}),e.jsxs(l.Cell,{children:[e.jsx("a",{href:"#",onClick:()=>O(s.id),className:"font-medium hover:no-underline text-cyan-600 dark:text-cyan-500 me-2",children:"Detail"}),e.jsx("a",{href:"#",className:"font-medium hover:no-underline text-green-600 dark:text-green-500",onClick:()=>$(s.id),children:"Delete"})]})]},t))})]}),e.jsx(G,{containerClassName:"pagination flex items-center my-4 mx-auto",pageClassName:"page-item p-2 font-semibold bg-gray-200 rounded-md mx-2 text-black",activeClassName:"active",onPageChange:s=>D(s.selected),pageCount:Math.ceil(h.length/p),breakLabel:"...",previousLabel:e.jsx(A.Provider,{value:{color:"#B8C1CC",size:"36px"},children:e.jsx(J,{})}),nextLabel:e.jsx(A.Provider,{value:{color:"#B8C1CC",size:"36px"},children:e.jsx(K,{})})}),e.jsxs(n,{show:M,onClose:()=>o(!1),children:[e.jsx(n.Header,{children:"Add User"}),e.jsx(n.Body,{children:e.jsxs("form",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"username-add",value:"Username"})}),e.jsx(i,{ref:f,id:"username-add",type:"text",placeholder:"Enter Username",required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"email-add",value:"Email"})}),e.jsx(i,{ref:v,id:"email-add",type:"email",placeholder:"name@gmail.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"noInduk-add",value:"No Induk"})}),e.jsx(i,{ref:g,id:"noInduk-add",type:"text",placeholder:"Enter ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"password-add",value:"Password"})}),e.jsx(i,{ref:C,id:"password-add",type:"password",placeholder:"Enter Password",required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"role-add",value:"Select User Role"})}),e.jsxs(S,{id:"role-add",ref:b,required:!0,children:[e.jsx("option",{value:"user",children:"Admin"}),e.jsx("option",{value:"student",children:"Student"})]})]})]})}),e.jsxs(n.Footer,{children:[e.jsx(c,{onClick:T,children:"Submit"}),e.jsx(c,{color:"gray",onClick:()=>o(!1),children:"Cancel"})]})]}),e.jsxs(n,{show:B,onClose:()=>j(!1),children:[e.jsx(n.Header,{children:"Edit User"}),e.jsx(n.Body,{children:e.jsxs("form",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"username-edit",value:"Username"})}),e.jsx(i,{id:"username-edit",type:"text",placeholder:"Enter Username",value:k,onChange:s=>y(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"email-edit",value:"Email"})}),e.jsx(i,{id:"email-edit",type:"email",placeholder:"name@gmail.com",value:E,onChange:s=>N(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"noInduk-edit",value:"No Induk"})}),e.jsx(i,{id:"noInduk-edit",type:"text",placeholder:"Enter ID",value:w,onChange:s=>U(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"password-edit",value:"Password"})}),e.jsx(i,{id:"password-edit",type:"password",placeholder:"Change Password",value:m,onChange:s=>q(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(r,{htmlFor:"role-edit",value:"Select User Role"})}),e.jsxs(S,{id:"role-edit",required:!0,value:I,onChange:s=>F(s.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"student",children:"Student"})]})]})]})}),e.jsxs(n.Footer,{children:[e.jsx(c,{onClick:()=>z(R),children:"Update"}),e.jsx(c,{color:"gray",onClick:()=>o(!1),children:"Cancel"})]})]})]})};export{ee as U};
